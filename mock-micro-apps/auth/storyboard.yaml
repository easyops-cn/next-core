app:
  name: Auth
  id: auth
  homepage: /auth
  noAuthGuard: true
routes:
- path: ${APP.homepage}/login
  bricks:
  - brick: basic.general-form
    properties:
      id: login-form
      layout: vertical
    events:
      validate.success:
      - action: console.log
        args:
        - validate.success
        - '<% EVENT.detail.username %>'
        - '<% EVENT.detail.password %>'
      - useProvider: basic.http-request
        args:
        - "api/auth/login/v2"
        - method: POST
          body:
            loginBy: easyops
            username: '<% EVENT.detail.username %>'
            password: '<% EVENT.detail.password %>'
        callback:
          success:
          - action: console.log
            args:
            - Login successfully
          - action: history.push
            args:
            - /
          error:
          - action: console.error
            args:
            - Login failed
            - '<% EVENT.detail %>'
          - action: handleHttpError
    children:
    - brick: basic.general-input
      properties:
        name: username
        label: Username
    - brick: basic.general-input
      properties:
        type: password
        name: password
        label: Password
    - brick: basic.general-button
      properties:
        type: primary
        textContent: Login
      events:
        click:
          target: "#login-form"
          method: validate
